<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>The Virtual Reality Passport search </title>
  <meta name="description" content="Aframe-Material">
  <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
  <script src="https://rawgit.com/mayognaise/aframe-mouse-cursor-component/master/dist/aframe-mouse-cursor-component.min.js"></script>
  <script src="https://unpkg.com/aframe-animation-component@3.2.5/dist/aframe-animation-component.min.js"></script>
 <!-- <script src="https://cdn.rawgit.com/etiennepinchon/aframe-material/master/dist/aframe-material.min.js"></script>-->
  <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"
          integrity="sha256-IyWBFJYclFY8Pn32bwWdSHmV4B9M5mby5bhPHEmeY8w=" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="js/manhole.js"></script>
  <!--<script src="js/discoverSearch.js"></script>-->
  <script src="js/vpp-app.js"></script>
  <script type="text/javascript">
	  AFRAME.ASSETS_PATH = "./assets";
  </script>
  <style>
    #map{
      width: 300px;
      height: 200px;
      z-index: 100;
      -webkit-box-shadow: 0px 0px 3px 3px rgba( 73, 73, 73, .2 );
      -moz-box-shadow: 0px 0px 3px 3px rgba( 73, 73, 73, .2 );
      -o-box-shadow: 0px 0px 3px 3px rgba( 73, 73, 73, .2 );
      box-shadow: 0px 0px 3px 3px rgba( 73, 73, 73, .2 );
    }
  </style>
</head>
<body>
<script type="x-shader/x-vertex" id="vs-sphere">

varying vec2 vUv;

void main() {

	vUv = vec2( 1. - uv.x, uv.y );
	vec4 mPosition = modelMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * modelViewMatrix * mPosition;

}

</script>

<script type="x-shader/x-fragment" id="fs-sphere">

uniform sampler2D map;
varying vec2 vUv;

void main() {

	gl_FragColor = vec4( texture2D( map, vUv ).rgb, 1. );

}

</script>
<a-scene>


  <a-entity laser-controls="hand: right"></a-entity>

  <a-entity id="camera" camera="" look-controls="" mouse-cursor="">

    <a-cursor id="cursor" cursor="fuse: false" scale="1.3 1.3 1.3"
              animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1.3 1.3 1.3; dur: 150"
              animation__fusing="property: fusing; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
              event-set__1="_event: mouseenter; color: #549ad5"
              event-set__2="_event: mouseleave; color: #ededed"
              raycaster="far: 20; objects: .clickable">
    </a-cursor>

  </a-entity>


  <a-entity manhole></a-entity>



  <!-- bottom nav row -->
  <a-entity id="nav-attach" nav="initialSelected: {{location}}"></a-entity>




  <a-sky data-array-link-id="loc_5" data-array="room" src="assets/images/loaction_5.jpg" visible="true" rotation="0 -90 0"></a-sky>


  <!-- END ENVIRONEMENT -->
</a-scene>
<div id="map"></div>

<div class="block">
  <form id="map_form">
    <input type="text" name="address" id="address" />
    <button type="submit" class="primary button" id="searchButton" >Search</button>
  </form>
</div>
<script>
  window.addEventListener('popstate', function(e) {
    //var character = e.state;
    console.log('state: ',e.state);
    var contentToDisplay = document.querySelector('a-image[data-page='+ e.state +']');
    if(contentToDisplay){
    	contentToDisplay.emit('click');
    }
  });
  console.log(AFRAME);
  var sne = document.querySelector('a-scene');
  sne.addEventListener('displayNewScene', function(){
  	console.log('displayNewScene event emitted');
  });
  sne.addEventListener('removal', function(){
	  console.log('removal event emitted');
  })
</script>
</body>
</html>
